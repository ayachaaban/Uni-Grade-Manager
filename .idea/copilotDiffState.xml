<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/unigrademanagerproject/UniGradeDBClass.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/unigrademanagerproject/UniGradeDBClass.java" />
              <option name="originalContent" value="package com.example.unigrademanagerproject;&#10;import android.content.ContentValues;&#10;import android.content.Context;&#10;import android.database.Cursor;&#10;import android.database.sqlite.SQLiteDatabase;&#10;import android.database.sqlite.SQLiteOpenHelper;&#10;import android.util.Log;&#10;&#10;import java.util.ArrayList;&#10;import java.util.HashMap;&#10;&#10;public class UniGradeDBClass extends SQLiteOpenHelper {&#10;&#10;&#10;    // Database Version&#10;    //bass nsewe update&#10;    private static final int DATABASE_VERSION = 1;&#10;&#10;    // Database Name&#10;    private static final String DATABASE_NAME = &quot;UniGradeDB&quot;;&#10;&#10;    // Table Name&#10;    private static final String TABLE_USERS = &quot;users&quot;;&#10;    private static final String TABLE_DOCTORS = &quot;doctors&quot;;&#10;    private static final String TABLE_STUDENTS = &quot;students&quot;;&#10;&#10;    // Constructor&#10;    public UniGradeDBClass(Context context) {&#10;        super(context, DATABASE_NAME, null, DATABASE_VERSION);&#10;&#10;    }&#10;&#10;    //create table&#10;    @Override&#10;    public void onCreate(SQLiteDatabase db) {&#10;        // Create Users Table&#10;        db.execSQL(&quot;CREATE TABLE &quot; + TABLE_USERS + &quot; (&quot; +&#10;                &quot;UserID INTEGER PRIMARY KEY AUTOINCREMENT, &quot; +&#10;                &quot;Username TEXT NOT NULL UNIQUE, &quot; +&#10;                &quot;Password TEXT NOT NULL, &quot; +&#10;                &quot;Role TEXT NOT NULL);&quot;);&#10;&#10;        // Create Doctors Table&#10;        db.execSQL(&quot;CREATE TABLE &quot; + TABLE_DOCTORS + &quot; (&quot; +&#10;                &quot;DoctorID INTEGER PRIMARY KEY AUTOINCREMENT, &quot; +&#10;                &quot;DoctorName TEXT NOT NULL, &quot; +&#10;                &quot;Email TEXT, &quot; +&#10;                &quot;Department TEXT, &quot; +&#10;                &quot;UserID INTEGER, &quot; +&#10;                &quot;FOREIGN KEY(UserID) REFERENCES &quot; + TABLE_USERS + &quot;(UserID));&quot;);&#10;&#10;        // Create Students Table&#10;        db.execSQL(&quot;CREATE TABLE &quot; + TABLE_STUDENTS + &quot; (&quot; +&#10;                &quot;StudentID INTEGER PRIMARY KEY AUTOINCREMENT, &quot; +&#10;                &quot;StudentName TEXT NOT NULL, &quot; +&#10;                &quot;StudentNumber TEXT NOT NULL, &quot; +&#10;                &quot;Course TEXT, &quot; +&#10;                &quot;Semester INTEGER, &quot; +&#10;                &quot;MidtermGrade INTEGER CHECK(MidtermGrade &gt;= 0 AND MidtermGrade &lt;= 30), &quot; +&#10;                &quot;AttendanceGrade INTEGER CHECK(AttendanceGrade &gt;= 0 AND AttendanceGrade &lt;= 10), &quot; +&#10;                &quot;FinalGrade INTEGER CHECK(FinalGrade &gt;= 0 AND FinalGrade &lt;= 60), &quot; +&#10;                &quot;TotalMarks INTEGER, &quot; +&#10;                &quot;LetterGrade TEXT, &quot; +&#10;                &quot;DoctorID INTEGER, &quot; +&#10;                &quot;FOREIGN KEY(DoctorID) REFERENCES &quot; + TABLE_DOCTORS + &quot;(DoctorID));&quot;);&#10;&#10;        // Insert Default Admin&#10;        ContentValues admin = new ContentValues();&#10;        admin.put(&quot;Username&quot;, &quot;admin&quot;);&#10;        admin.put(&quot;Password&quot;, &quot;admin123&quot;);&#10;        admin.put(&quot;Role&quot;, &quot;Admin&quot;);&#10;        db.insert(TABLE_USERS, null, admin);&#10;&#10;        Log.d(&quot;CREATE TABLE&quot;, &quot;All tables created successfully.&quot;);&#10;    }&#10;    public Cursor loginUser(String username, String password, String role) {&#10;        SQLiteDatabase db = this.getReadableDatabase();&#10;        //db.query() - Android's method to query SQLite database&#10;        //TABLE_USERS - The table name (&quot;users&quot;)&#10;        //new String[]{&quot;UserID&quot;, &quot;Role&quot;}:like SELECT UserID, Role FROM users&#10;        //  &quot;Username=? AND Password=? AND Role=?&quot;: the WHERE clause&#10;        // new String[]{username, password, role}: the values to replace the ? in the WHERE clause&#10;        //null, null, null: groupBy, having, orderBy (not used here)&#10;        return db.query(TABLE_USERS,&#10;                new String[]{&quot;UserID&quot;, &quot;Role&quot;},&#10;                &quot;Username=? AND Password=? AND Role=?&quot;,&#10;                new String[]{username, password, role},&#10;                null, null, null);&#10;        //A Cursor is like a finger pointing at rows in this table&#10;        //The return statement gives you this Cursor object so you can check if login was successful and get the user's data&#10;        // If a matching user is found, the Cursor will contain that user's UserID and Role&#10;        // If no match is found, the Cursor will be empty&#10;    }&#10;&#10;    //  Check if Username Exists&#10;    public boolean isUsernameExists(String username) {&#10;        SQLiteDatabase db = this.getReadableDatabase();&#10;        Cursor cursor = db.query(TABLE_USERS,&#10;                new String[]{&quot;UserID&quot;},&#10;                &quot;Username=?&quot;,&#10;                new String[]{username},&#10;                null, null, null);&#10;&#10;        boolean exists = cursor.getCount() &gt; 0;&#10;        cursor.close();&#10;        return exists;&#10;    }&#10;&#10;&#10;    //  Register Doctor&#10;    public boolean registerDoctor(String username, String password, String doctorName, String email, String department) {&#10;        SQLiteDatabase db = this.getWritableDatabase();&#10;&#10;        try {&#10;            // Step 1: Insert into users table first&#10;            ContentValues userValues = new ContentValues();&#10;            userValues.put(&quot;Username&quot;, username);&#10;            userValues.put(&quot;Password&quot;, password);&#10;            userValues.put(&quot;Role&quot;, &quot;Doctor&quot;);&#10;            // Insert user and get the auto generated UserID(primary key)&#10;            long userID = db.insert(TABLE_USERS, null, userValues);&#10;            if (userID == -1) {&#10;                Log.e(&quot;DB_ERROR&quot;, &quot;Failed to insert user&quot;);&#10;                return false;&#10;            }&#10;&#10;            // Step 2: Insert into doctors table&#10;            ContentValues doctorValues = new ContentValues();&#10;            doctorValues.put(&quot;DoctorName&quot;, doctorName);&#10;            doctorValues.put(&quot;Email&quot;, email);&#10;            doctorValues.put(&quot;Department&quot;, department);&#10;            doctorValues.put(&quot;UserID&quot;, userID);// Foreign key reference to users table&#10;&#10;            long doctorID = db.insert(TABLE_DOCTORS, null, doctorValues);&#10;&#10;            if (doctorID == -1) {&#10;                Log.e(&quot;DB_ERROR&quot;, &quot;Failed to insert doctor&quot;);&#10;                return false;&#10;            }&#10;            Log.d(&quot;DB_SUCCESS&quot;, &quot;Doctor registered with DoctorID: &quot; + doctorID);&#10;            return true;&#10;&#10;        } catch (Exception e) {&#10;            Log.e(&quot;DB_ERROR&quot;, &quot;Error registering doctor: &quot; + e.getMessage());&#10;            return false;&#10;        }&#10;    }&#10;    // Get All Doctors&#10;    public ArrayList&lt;HashMap&lt;String, String&gt;&gt; getAllDoctors() {&#10;        ArrayList&lt;HashMap&lt;String, String&gt;&gt; list = new ArrayList&lt;&gt;();&#10;        SQLiteDatabase db = this.getReadableDatabase();&#10;&#10;        // JOIN users and doctors tables&#10;        String query = &quot;SELECT d.DoctorID, d.DoctorName, d.Department, d.Email, u.Username &quot; +&#10;                &quot;FROM &quot; + TABLE_DOCTORS + &quot; d &quot; +&#10;                &quot;INNER JOIN &quot; + TABLE_USERS + &quot; u ON d.UserID = u.UserID &quot; +&#10;                &quot;WHERE u.Role = 'Doctor'&quot;;&#10;&#10;        Cursor cursor = db.rawQuery(query, null);&#10;&#10;        Log.d(&quot;DB_DEBUG&quot;, &quot;Query executed. Row count: &quot; + cursor.getCount());&#10;&#10;        if (cursor.moveToFirst()) {&#10;            do {&#10;                HashMap&lt;String, String&gt; map = new HashMap&lt;&gt;();&#10;                map.put(&quot;DoctorID&quot;, cursor.getString(0));      // d.DoctorID&#10;                map.put(&quot;Name&quot;, cursor.getString(1));          // d.DoctorName&#10;                map.put(&quot;Department&quot;, cursor.getString(2));    // d.Department&#10;                map.put(&quot;Email&quot;, cursor.getString(3));         // d.Email&#10;                map.put(&quot;Username&quot;, cursor.getString(4));      // u.Username&#10;&#10;                Log.d(&quot;DOCTOR_DATA&quot;, &quot;ID: &quot; + cursor.getString(0) +&#10;                        &quot;, Name: &quot; + cursor.getString(1) +&#10;                        &quot;, Dept: &quot; + cursor.getString(2) +&#10;                        &quot;, Email: &quot; + cursor.getString(3) +&#10;                        &quot;, User: &quot; + cursor.getString(4));&#10;&#10;                list.add(map);&#10;            } while (cursor.moveToNext());&#10;        } else {&#10;            Log.d(&quot;DB_DEBUG&quot;, &quot;No doctors found in database!&quot;);&#10;        }&#10;        cursor.close();&#10;        db.close();&#10;&#10;        Log.d(&quot;DB_DEBUG&quot;, &quot;Returning list with &quot; + list.size() + &quot; doctors&quot;);&#10;        return list;&#10;    }&#10;&#10;    // Update doctor&#10;    public boolean updateDoctor(String doctorID, String name, String email, String department, String username, String password) {&#10;        SQLiteDatabase db = this.getWritableDatabase();&#10;&#10;        try {&#10;            Cursor cursor = db.rawQuery(&quot;SELECT UserID FROM &quot; + TABLE_DOCTORS + &quot; WHERE DoctorID = ?&quot;, new String[]{doctorID});&#10;            if (!cursor.moveToFirst()) {&#10;                cursor.close();&#10;                return false;&#10;            }&#10;            int userID = cursor.getInt(0);&#10;            cursor.close();&#10;&#10;            ContentValues doctorValues = new ContentValues();&#10;            doctorValues.put(&quot;DoctorName&quot;, name);&#10;            doctorValues.put(&quot;Email&quot;, email);&#10;            doctorValues.put(&quot;Department&quot;, department);&#10;            int doctorRows = db.update(TABLE_DOCTORS, doctorValues, &quot;DoctorID = ?&quot;, new String[]{doctorID});&#10;&#10;            ContentValues userValues = new ContentValues();&#10;            userValues.put(&quot;Username&quot;, username);&#10;            userValues.put(&quot;Password&quot;, password);&#10;            int userRows = db.update(TABLE_USERS, userValues, &quot;UserID = ?&quot;, new String[]{String.valueOf(userID)});&#10;&#10;            return (doctorRows &gt; 0 &amp;&amp; userRows &gt; 0);&#10;        } catch (Exception e) {&#10;            Log.e(&quot;DB_ERROR&quot;, &quot;Error updating doctor: &quot; + e.getMessage());&#10;            return false;&#10;        } finally {&#10;            db.close();&#10;        }&#10;    }&#10;&#10;    // Delete doctor&#10;    public boolean deleteDoctor(String doctorID) {&#10;        SQLiteDatabase db = this.getWritableDatabase();&#10;&#10;        try {&#10;            Cursor cursor = db.rawQuery(&quot;SELECT UserID FROM &quot; + TABLE_DOCTORS + &quot; WHERE DoctorID = ?&quot;, new String[]{doctorID});&#10;            if (!cursor.moveToFirst()) {&#10;                cursor.close();&#10;                return false;&#10;            }&#10;            int userID = cursor.getInt(0);&#10;            cursor.close();&#10;&#10;            int doctorRows = db.delete(TABLE_DOCTORS, &quot;DoctorID = ?&quot;, new String[]{doctorID});&#10;            int userRows = db.delete(TABLE_USERS, &quot;UserID = ?&quot;, new String[]{String.valueOf(userID)});&#10;&#10;            return (doctorRows &gt; 0 &amp;&amp; userRows &gt; 0);&#10;        } catch (Exception e) {&#10;            Log.e(&quot;DB_ERROR&quot;, &quot;Error deleting doctor: &quot; + e.getMessage());&#10;            return false;&#10;        } finally {&#10;            db.close();&#10;        }&#10;    }&#10;    public boolean addStudent(String id, String name, String course, String semester,&#10;                              double attendance, double midterm, double finalExam,&#10;                              double total, String grade,String doctorID) {&#10;        SQLiteDatabase db = this.getWritableDatabase();&#10;        ContentValues values = new ContentValues();&#10;        values.put(&quot;StudentNumber&quot;, id);&#10;        values.put(&quot;StudentName&quot;, name);&#10;        values.put(&quot;Course&quot;, course);&#10;        values.put(&quot;Semester&quot;, semester);&#10;        values.put(&quot;AttendanceGrade&quot;, attendance);&#10;        values.put(&quot;MidtermGrade&quot;, midterm);&#10;        values.put(&quot;FinalGrade&quot;, finalExam);&#10;        values.put(&quot;TotalMarks&quot;, total);&#10;        values.put(&quot;LetterGrade&quot;, grade);&#10;        values.put(&quot;DoctorID&quot;, doctorID);&#10;&#10;        long result = db.insert(TABLE_STUDENTS, null, values);&#10;        db.close();&#10;        return result != -1;&#10;    }&#10;    // Get Doctor by ID&#10;    public HashMap&lt;String, String&gt; getDoctorById(String doctorID) {&#10;        HashMap&lt;String, String&gt; doctor = new HashMap&lt;&gt;();&#10;        SQLiteDatabase db = this.getReadableDatabase();&#10;&#10;        String query = &quot;SELECT d.DoctorID, d.DoctorName, d.Department, d.Email, u.Username, u.Password &quot; +&#10;                &quot;FROM &quot; + TABLE_DOCTORS + &quot; d &quot; +&#10;                &quot;INNER JOIN &quot; + TABLE_USERS + &quot; u ON d.UserID = u.UserID &quot; +&#10;                &quot;WHERE d.DoctorID = ?&quot;;&#10;&#10;        Cursor cursor = db.rawQuery(query, new String[]{doctorID});&#10;&#10;        if (cursor.moveToFirst()) {&#10;            doctor.put(&quot;DoctorID&quot;, cursor.getString(0));&#10;            doctor.put(&quot;Name&quot;, cursor.getString(1));&#10;            doctor.put(&quot;Department&quot;, cursor.getString(2));&#10;            doctor.put(&quot;Email&quot;, cursor.getString(3));&#10;            doctor.put(&quot;Username&quot;, cursor.getString(4));&#10;            doctor.put(&quot;Password&quot;, cursor.getString(5));&#10;        }&#10;&#10;        cursor.close();&#10;        db.close();&#10;        return doctor;&#10;    }&#10;&#10;    // Get All Students with Doctor Info&#10;    public ArrayList&lt;HashMap&lt;String, String&gt;&gt; getAllStudents() {&#10;        ArrayList&lt;HashMap&lt;String, String&gt;&gt; list = new ArrayList&lt;&gt;();&#10;        SQLiteDatabase db = this.getReadableDatabase();&#10;&#10;        String query = &quot;SELECT s.StudentID, s.StudentName, s.Course, s.AttendanceGrade, &quot; +&#10;                &quot;s.MidtermGrade, s.FinalGrade, s.TotalMarks, d.DoctorName &quot; +&#10;                &quot;FROM &quot; + TABLE_STUDENTS + &quot; s &quot; +&#10;                &quot;LEFT JOIN &quot; + TABLE_DOCTORS + &quot; d ON s.DoctorID = d.DoctorID&quot;;&#10;&#10;        Cursor cursor = db.rawQuery(query, null);&#10;&#10;        if (cursor.moveToFirst()) {&#10;            do {&#10;                HashMap&lt;String, String&gt; map = new HashMap&lt;&gt;();&#10;                map.put(&quot;StudentID&quot;, cursor.getString(0));&#10;                map.put(&quot;StudentName&quot;, cursor.getString(1));&#10;                map.put(&quot;Course&quot;, cursor.getString(2));&#10;                map.put(&quot;AttendanceGrade&quot;, cursor.getString(3));&#10;                map.put(&quot;MidtermGrade&quot;, cursor.getString(4));&#10;                map.put(&quot;FinalGrade&quot;, cursor.getString(5));&#10;                map.put(&quot;TotalMarks&quot;, cursor.getString(6));&#10;                map.put(&quot;DoctorName&quot;, cursor.getString(7) != null ? cursor.getString(7) : &quot;No Doctor&quot;);&#10;                list.add(map);&#10;            } while (cursor.moveToNext());&#10;        }&#10;        cursor.close();&#10;        db.close();&#10;        return list;&#10;    }&#10;&#10;    // Get students registered by a specific doctor&#10;    public ArrayList&lt;HashMap&lt;String, String&gt;&gt; getStudentsByDoctorId(String doctorId) {&#10;        ArrayList&lt;HashMap&lt;String, String&gt;&gt; list = new ArrayList&lt;&gt;();&#10;        SQLiteDatabase db = this.getReadableDatabase();&#10;&#10;        String query = &quot;SELECT s.StudentID, s.StudentName, s.Course, s.AttendanceGrade, &quot; +&#10;                &quot;s.MidtermGrade, s.FinalGrade, s.TotalMarks &quot; +&#10;                &quot;FROM &quot; + TABLE_STUDENTS + &quot; s &quot; +&#10;                &quot;WHERE s.DoctorID = ?&quot;;&#10;&#10;        Cursor cursor = db.rawQuery(query, new String[]{doctorId});&#10;&#10;        if (cursor.moveToFirst()) {&#10;            do {&#10;                HashMap&lt;String, String&gt; map = new HashMap&lt;&gt;();&#10;                map.put(&quot;StudentID&quot;, cursor.getString(0));&#10;                map.put(&quot;StudentName&quot;, cursor.getString(1));&#10;                map.put(&quot;Course&quot;, cursor.getString(2));&#10;                map.put(&quot;AttendanceGrade&quot;, cursor.getString(3));&#10;                map.put(&quot;MidtermGrade&quot;, cursor.getString(4));&#10;                map.put(&quot;FinalGrade&quot;, cursor.getString(5));&#10;                map.put(&quot;TotalMarks&quot;, cursor.getString(6));&#10;                list.add(map);&#10;            } while (cursor.moveToNext());&#10;        }&#10;        cursor.close();&#10;        db.close();&#10;        return list;&#10;    }&#10;&#10;    public String getDoctorIdByUserId(int userId) {&#10;        SQLiteDatabase db = this.getReadableDatabase();&#10;        String doctorId = null;&#10;        Cursor cursor = null;&#10;        try {&#10;            cursor = db.rawQuery(&quot;SELECT DoctorID FROM &quot; + TABLE_DOCTORS + &quot; WHERE UserID = ?&quot;, new String[]{String.valueOf(userId)});&#10;            if (cursor != null &amp;&amp; cursor.moveToFirst()) {&#10;                doctorId = cursor.getString(0);&#10;            }&#10;        } catch (Exception e) {&#10;            android.util.Log.e(&quot;DB_ERROR&quot;, &quot;getDoctorIdByUserId: &quot; + e.getMessage());&#10;        } finally {&#10;            if (cursor != null) cursor.close();&#10;            db.close();&#10;        }&#10;        return doctorId;&#10;    }&#10;    public boolean deleteStudent(String studentID) {&#10;        SQLiteDatabase db = this.getWritableDatabase();&#10;        try {&#10;            int rows = db.delete(TABLE_STUDENTS, &quot;StudentID = ?&quot;, new String[]{studentID});&#10;            return rows &gt; 0;&#10;        } catch (Exception e) {&#10;            Log.e(&quot;DB_ERROR&quot;, &quot;Error deleting student: &quot; + e.getMessage());&#10;            return false;&#10;        } finally {&#10;            db.close();&#10;        }&#10;    }&#10;    public boolean updateStudent(String studentID, String courseName, double attendance,&#10;                                 double mid, double finalExam, double total, String grade) {&#10;        SQLiteDatabase db = this.getWritableDatabase();&#10;        ContentValues values = new ContentValues();&#10;        values.put(&quot;Course&quot;, courseName);&#10;        values.put(&quot;AttendanceGrade&quot;, attendance);&#10;        values.put(&quot;MidtermGrade&quot;, mid);&#10;        values.put(&quot;FinalGrade&quot;, finalExam);&#10;        values.put(&quot;TotalMarks&quot;, total);&#10;        values.put(&quot;LetterGrade&quot;, grade);&#10;&#10;        int rows = db.update(TABLE_STUDENTS, values, &quot;StudentID=?&quot;, new String[]{studentID});&#10;        db.close();&#10;        return rows &gt; 0;&#10;    }&#10;&#10;    @Override&#10;    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {&#10;        db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_STUDENTS);&#10;        db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_DOCTORS);&#10;        db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_USERS);&#10;        onCreate(db);&#10;    }&#10;&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.unigrademanagerproject;&#10;import android.content.ContentValues;&#10;import android.content.Context;&#10;import android.database.Cursor;&#10;import android.database.sqlite.SQLiteDatabase;&#10;import android.database.sqlite.SQLiteOpenHelper;&#10;import android.util.Log;&#10;&#10;import java.util.ArrayList;&#10;import java.util.HashMap;&#10;&#10;public class UniGradeDBClass extends SQLiteOpenHelper {&#10;&#10;&#10;    // Database Version&#10;    //bass nsewe update&#10;    private static final int DATABASE_VERSION = 1;&#10;&#10;    // Database Name&#10;    private static final String DATABASE_NAME = &quot;UniGradeDB&quot;;&#10;&#10;    // Table Name&#10;    private static final String TABLE_USERS = &quot;users&quot;;&#10;    private static final String TABLE_DOCTORS = &quot;doctors&quot;;&#10;    private static final String TABLE_STUDENTS = &quot;students&quot;;&#10;&#10;    // Constructor&#10;    public UniGradeDBClass(Context context) {&#10;        super(context, DATABASE_NAME, null, DATABASE_VERSION);&#10;&#10;    }&#10;&#10;    //create table&#10;    @Override&#10;    public void onCreate(SQLiteDatabase db) {&#10;        // Create Users Table&#10;        db.execSQL(&quot;CREATE TABLE &quot; + TABLE_USERS + &quot; (&quot; +&#10;                &quot;UserID INTEGER PRIMARY KEY AUTOINCREMENT, &quot; +&#10;                &quot;Username TEXT NOT NULL UNIQUE, &quot; +&#10;                &quot;Password TEXT NOT NULL, &quot; +&#10;                &quot;Role TEXT NOT NULL);&quot;);&#10;&#10;        // Create Doctors Table&#10;        db.execSQL(&quot;CREATE TABLE &quot; + TABLE_DOCTORS + &quot; (&quot; +&#10;                &quot;DoctorID INTEGER PRIMARY KEY AUTOINCREMENT, &quot; +&#10;                &quot;DoctorName TEXT NOT NULL, &quot; +&#10;                &quot;Email TEXT, &quot; +&#10;                &quot;Department TEXT, &quot; +&#10;                &quot;UserID INTEGER, &quot; +&#10;                &quot;FOREIGN KEY(UserID) REFERENCES &quot; + TABLE_USERS + &quot;(UserID));&quot;);&#10;&#10;        // Create Students Table&#10;        db.execSQL(&quot;CREATE TABLE &quot; + TABLE_STUDENTS + &quot; (&quot; +&#10;                &quot;StudentID INTEGER PRIMARY KEY AUTOINCREMENT, &quot; +&#10;                &quot;StudentName TEXT NOT NULL, &quot; +&#10;                &quot;StudentNumber TEXT NOT NULL, &quot; +&#10;                &quot;Course TEXT, &quot; +&#10;                &quot;Semester INTEGER, &quot; +&#10;                &quot;MidtermGrade INTEGER CHECK(MidtermGrade &gt;= 0 AND MidtermGrade &lt;= 30), &quot; +&#10;                &quot;AttendanceGrade INTEGER CHECK(AttendanceGrade &gt;= 0 AND AttendanceGrade &lt;= 10), &quot; +&#10;                &quot;FinalGrade INTEGER CHECK(FinalGrade &gt;= 0 AND FinalGrade &lt;= 60), &quot; +&#10;                &quot;TotalMarks INTEGER, &quot; +&#10;                &quot;LetterGrade TEXT, &quot; +&#10;                &quot;DoctorID INTEGER, &quot; +&#10;                &quot;FOREIGN KEY(DoctorID) REFERENCES &quot; + TABLE_DOCTORS + &quot;(DoctorID));&quot;);&#10;&#10;        // Insert Default Admin&#10;        ContentValues admin = new ContentValues();&#10;        admin.put(&quot;Username&quot;, &quot;admin&quot;);&#10;        admin.put(&quot;Password&quot;, &quot;admin123&quot;);&#10;        admin.put(&quot;Role&quot;, &quot;Admin&quot;);&#10;        db.insert(TABLE_USERS, null, admin);&#10;&#10;        Log.d(&quot;CREATE TABLE&quot;, &quot;All tables created successfully.&quot;);&#10;    }&#10;    public Cursor loginUser(String username, String password, String role) {&#10;        SQLiteDatabase db = this.getReadableDatabase();&#10;        //db.query() - Android's method to query SQLite database&#10;        //TABLE_USERS - The table name (&quot;users&quot;)&#10;        //new String[]{&quot;UserID&quot;, &quot;Role&quot;}:like SELECT UserID, Role FROM users&#10;        //  &quot;Username=? AND Password=? AND Role=?&quot;: the WHERE clause&#10;        // new String[]{username, password, role}: the values to replace the ? in the WHERE clause&#10;        //null, null, null: groupBy, having, orderBy (not used here)&#10;        return db.query(TABLE_USERS,&#10;                new String[]{&quot;UserID&quot;, &quot;Role&quot;},&#10;                &quot;Username=? AND Password=? AND Role=?&quot;,&#10;                new String[]{username, password, role},&#10;                null, null, null);&#10;        //A Cursor is like a finger pointing at rows in this table&#10;        //The return statement gives you this Cursor object so you can check if login was successful and get the user's data&#10;        // If a matching user is found, the Cursor will contain that user's UserID and Role&#10;        // If no match is found, the Cursor will be empty&#10;    }&#10;&#10;    //  Check if Username Exists&#10;    public boolean isUsernameExists(String username) {&#10;        SQLiteDatabase db = this.getReadableDatabase();&#10;        Cursor cursor = db.query(TABLE_USERS,&#10;                new String[]{&quot;UserID&quot;},&#10;                &quot;Username=?&quot;,&#10;                new String[]{username},&#10;                null, null, null);&#10;&#10;        boolean exists = cursor.getCount() &gt; 0;&#10;        cursor.close();&#10;        return exists;&#10;    }&#10;&#10;&#10;    //  Register Doctor&#10;    public boolean registerDoctor(String username, String password, String doctorName, String email, String department) {&#10;        SQLiteDatabase db = this.getWritableDatabase();&#10;&#10;        try {&#10;            // Step 1: Insert into users table first&#10;            ContentValues userValues = new ContentValues();&#10;            userValues.put(&quot;Username&quot;, username);&#10;            userValues.put(&quot;Password&quot;, password);&#10;            userValues.put(&quot;Role&quot;, &quot;Doctor&quot;);&#10;            // Insert user and get the auto generated UserID(primary key)&#10;            long userID = db.insert(TABLE_USERS, null, userValues);&#10;            if (userID == -1) {&#10;                Log.e(&quot;DB_ERROR&quot;, &quot;Failed to insert user&quot;);&#10;                return false;&#10;            }&#10;&#10;            // Step 2: Insert into doctors table&#10;            ContentValues doctorValues = new ContentValues();&#10;            doctorValues.put(&quot;DoctorName&quot;, doctorName);&#10;            doctorValues.put(&quot;Email&quot;, email);&#10;            doctorValues.put(&quot;Department&quot;, department);&#10;            doctorValues.put(&quot;UserID&quot;, userID);// Foreign key reference to users table&#10;&#10;            long doctorID = db.insert(TABLE_DOCTORS, null, doctorValues);&#10;&#10;            if (doctorID == -1) {&#10;                Log.e(&quot;DB_ERROR&quot;, &quot;Failed to insert doctor&quot;);&#10;                return false;&#10;            }&#10;            Log.d(&quot;DB_SUCCESS&quot;, &quot;Doctor registered with DoctorID: &quot; + doctorID);&#10;            return true;&#10;&#10;        } catch (Exception e) {&#10;            Log.e(&quot;DB_ERROR&quot;, &quot;Error registering doctor: &quot; + e.getMessage());&#10;            return false;&#10;        }&#10;    }&#10;    // Get All Doctors&#10;    public ArrayList&lt;HashMap&lt;String, String&gt;&gt; getAllDoctors() {&#10;        ArrayList&lt;HashMap&lt;String, String&gt;&gt; list = new ArrayList&lt;&gt;();&#10;        SQLiteDatabase db = this.getReadableDatabase();&#10;&#10;        // JOIN users and doctors tables&#10;        String query = &quot;SELECT d.DoctorID, d.DoctorName, d.Department, d.Email, u.Username &quot; +&#10;                &quot;FROM &quot; + TABLE_DOCTORS + &quot; d &quot; +&#10;                &quot;INNER JOIN &quot; + TABLE_USERS + &quot; u ON d.UserID = u.UserID &quot; +&#10;                &quot;WHERE u.Role = 'Doctor'&quot;;&#10;&#10;        Cursor cursor = db.rawQuery(query, null);&#10;&#10;        Log.d(&quot;DB_DEBUG&quot;, &quot;Query executed. Row count: &quot; + cursor.getCount());&#10;&#10;        if (cursor.moveToFirst()) {&#10;            do {&#10;                HashMap&lt;String, String&gt; map = new HashMap&lt;&gt;();&#10;                map.put(&quot;DoctorID&quot;, cursor.getString(0));      // d.DoctorID&#10;                map.put(&quot;Name&quot;, cursor.getString(1));          // d.DoctorName&#10;                map.put(&quot;Department&quot;, cursor.getString(2));    // d.Department&#10;                map.put(&quot;Email&quot;, cursor.getString(3));         // d.Email&#10;                map.put(&quot;Username&quot;, cursor.getString(4));      // u.Username&#10;&#10;                Log.d(&quot;DOCTOR_DATA&quot;, &quot;ID: &quot; + cursor.getString(0) +&#10;                        &quot;, Name: &quot; + cursor.getString(1) +&#10;                        &quot;, Dept: &quot; + cursor.getString(2) +&#10;                        &quot;, Email: &quot; + cursor.getString(3) +&#10;                        &quot;, User: &quot; + cursor.getString(4));&#10;&#10;                list.add(map);&#10;            } while (cursor.moveToNext());&#10;        } else {&#10;            Log.d(&quot;DB_DEBUG&quot;, &quot;No doctors found in database!&quot;);&#10;        }&#10;        cursor.close();&#10;        db.close();&#10;&#10;        Log.d(&quot;DB_DEBUG&quot;, &quot;Returning list with &quot; + list.size() + &quot; doctors&quot;);&#10;        return list;&#10;    }&#10;&#10;    // Update doctor&#10;    public boolean updateDoctor(String doctorID, String name, String email, String department, String username, String password) {&#10;        SQLiteDatabase db = this.getWritableDatabase();&#10;&#10;        try {&#10;            Cursor cursor = db.rawQuery(&quot;SELECT UserID FROM &quot; + TABLE_DOCTORS + &quot; WHERE DoctorID = ?&quot;, new String[]{doctorID});&#10;            if (!cursor.moveToFirst()) {&#10;                cursor.close();&#10;                return false;&#10;            }&#10;            int userID = cursor.getInt(0);&#10;            cursor.close();&#10;&#10;            ContentValues doctorValues = new ContentValues();&#10;            doctorValues.put(&quot;DoctorName&quot;, name);&#10;            doctorValues.put(&quot;Email&quot;, email);&#10;            doctorValues.put(&quot;Department&quot;, department);&#10;            int doctorRows = db.update(TABLE_DOCTORS, doctorValues, &quot;DoctorID = ?&quot;, new String[]{doctorID});&#10;&#10;            ContentValues userValues = new ContentValues();&#10;            userValues.put(&quot;Username&quot;, username);&#10;            userValues.put(&quot;Password&quot;, password);&#10;            int userRows = db.update(TABLE_USERS, userValues, &quot;UserID = ?&quot;, new String[]{String.valueOf(userID)});&#10;&#10;            return (doctorRows &gt; 0 &amp;&amp; userRows &gt; 0);&#10;        } catch (Exception e) {&#10;            Log.e(&quot;DB_ERROR&quot;, &quot;Error updating doctor: &quot; + e.getMessage());&#10;            return false;&#10;        } finally {&#10;            db.close();&#10;        }&#10;    }&#10;&#10;    // Delete doctor&#10;    public boolean deleteDoctor(String doctorID) {&#10;        SQLiteDatabase db = this.getWritableDatabase();&#10;&#10;        try {&#10;            Cursor cursor = db.rawQuery(&quot;SELECT UserID FROM &quot; + TABLE_DOCTORS + &quot; WHERE DoctorID = ?&quot;, new String[]{doctorID});&#10;            if (!cursor.moveToFirst()) {&#10;                cursor.close();&#10;                return false;&#10;            }&#10;            int userID = cursor.getInt(0);&#10;            cursor.close();&#10;&#10;            int doctorRows = db.delete(TABLE_DOCTORS, &quot;DoctorID = ?&quot;, new String[]{doctorID});&#10;            int userRows = db.delete(TABLE_USERS, &quot;UserID = ?&quot;, new String[]{String.valueOf(userID)});&#10;&#10;            return (doctorRows &gt; 0 &amp;&amp; userRows &gt; 0);&#10;        } catch (Exception e) {&#10;            Log.e(&quot;DB_ERROR&quot;, &quot;Error deleting doctor: &quot; + e.getMessage());&#10;            return false;&#10;        } finally {&#10;            db.close();&#10;        }&#10;    }&#10;    public boolean addStudent(String id, String name, String course, String semester,&#10;                              double attendance, double midterm, double finalExam,&#10;                              double total, String grade,String doctorID) {&#10;        SQLiteDatabase db = this.getWritableDatabase();&#10;        ContentValues values = new ContentValues();&#10;        values.put(&quot;StudentNumber&quot;, id);&#10;        values.put(&quot;StudentName&quot;, name);&#10;        values.put(&quot;Course&quot;, course);&#10;        values.put(&quot;Semester&quot;, semester);&#10;        values.put(&quot;AttendanceGrade&quot;, attendance);&#10;        values.put(&quot;MidtermGrade&quot;, midterm);&#10;        values.put(&quot;FinalGrade&quot;, finalExam);&#10;        values.put(&quot;TotalMarks&quot;, total);&#10;        values.put(&quot;LetterGrade&quot;, grade);&#10;        values.put(&quot;DoctorID&quot;, doctorID);&#10;&#10;        long result = db.insert(TABLE_STUDENTS, null, values);&#10;        db.close();&#10;        return result != -1;&#10;    }&#10;    // Get Doctor by ID&#10;    public HashMap&lt;String, String&gt; getDoctorById(String doctorID) {&#10;        HashMap&lt;String, String&gt; doctor = new HashMap&lt;&gt;();&#10;        SQLiteDatabase db = this.getReadableDatabase();&#10;&#10;        String query = &quot;SELECT d.DoctorID, d.DoctorName, d.Department, d.Email, u.Username, u.Password &quot; +&#10;                &quot;FROM &quot; + TABLE_DOCTORS + &quot; d &quot; +&#10;                &quot;INNER JOIN &quot; + TABLE_USERS + &quot; u ON d.UserID = u.UserID &quot; +&#10;                &quot;WHERE d.DoctorID = ?&quot;;&#10;&#10;        Cursor cursor = db.rawQuery(query, new String[]{doctorID});&#10;&#10;        if (cursor.moveToFirst()) {&#10;            doctor.put(&quot;DoctorID&quot;, cursor.getString(0));&#10;            doctor.put(&quot;Name&quot;, cursor.getString(1));&#10;            doctor.put(&quot;Department&quot;, cursor.getString(2));&#10;            doctor.put(&quot;Email&quot;, cursor.getString(3));&#10;            doctor.put(&quot;Username&quot;, cursor.getString(4));&#10;            doctor.put(&quot;Password&quot;, cursor.getString(5));&#10;        }&#10;&#10;        cursor.close();&#10;        db.close();&#10;        return doctor;&#10;    }&#10;&#10;    // Get All Students with Doctor Info&#10;    public ArrayList&lt;HashMap&lt;String, String&gt;&gt; getAllStudents() {&#10;        ArrayList&lt;HashMap&lt;String, String&gt;&gt; list = new ArrayList&lt;&gt;();&#10;        SQLiteDatabase db = this.getReadableDatabase();&#10;&#10;        String query = &quot;SELECT s.StudentID, s.StudentName, s.Course, s.AttendanceGrade, &quot; +&#10;                &quot;s.MidtermGrade, s.FinalGrade, s.TotalMarks, d.DoctorName &quot; +&#10;                &quot;FROM &quot; + TABLE_STUDENTS + &quot; s &quot; +&#10;                &quot;LEFT JOIN &quot; + TABLE_DOCTORS + &quot; d ON s.DoctorID = d.DoctorID&quot;;&#10;&#10;        Cursor cursor = db.rawQuery(query, null);&#10;&#10;        if (cursor.moveToFirst()) {&#10;            do {&#10;                HashMap&lt;String, String&gt; map = new HashMap&lt;&gt;();&#10;                map.put(&quot;StudentID&quot;, cursor.getString(0));&#10;                map.put(&quot;StudentName&quot;, cursor.getString(1));&#10;                map.put(&quot;Course&quot;, cursor.getString(2));&#10;                map.put(&quot;AttendanceGrade&quot;, cursor.getString(3));&#10;                map.put(&quot;MidtermGrade&quot;, cursor.getString(4));&#10;                map.put(&quot;FinalGrade&quot;, cursor.getString(5));&#10;                map.put(&quot;TotalMarks&quot;, cursor.getString(6));&#10;                map.put(&quot;DoctorName&quot;, cursor.getString(7) != null ? cursor.getString(7) : &quot;No Doctor&quot;);&#10;                list.add(map);&#10;            } while (cursor.moveToNext());&#10;        }&#10;        cursor.close();&#10;        db.close();&#10;        return list;&#10;    }&#10;&#10;    // Get students registered by a specific doctor&#10;    public ArrayList&lt;HashMap&lt;String, String&gt;&gt; getStudentsByDoctorId(String doctorId) {&#10;        ArrayList&lt;HashMap&lt;String, String&gt;&gt; list = new ArrayList&lt;&gt;();&#10;        SQLiteDatabase db = this.getReadableDatabase();&#10;&#10;        String query = &quot;SELECT s.StudentID, s.StudentName, s.Course, s.AttendanceGrade, &quot; +&#10;                &quot;s.MidtermGrade, s.FinalGrade, s.TotalMarks &quot; +&#10;                &quot;FROM &quot; + TABLE_STUDENTS + &quot; s &quot; +&#10;                &quot;WHERE s.DoctorID = ?&quot;;&#10;&#10;        Cursor cursor = db.rawQuery(query, new String[]{doctorId});&#10;&#10;        if (cursor.moveToFirst()) {&#10;            do {&#10;                HashMap&lt;String, String&gt; map = new HashMap&lt;&gt;();&#10;                map.put(&quot;StudentID&quot;, cursor.getString(0));&#10;                map.put(&quot;StudentName&quot;, cursor.getString(1));&#10;                map.put(&quot;Course&quot;, cursor.getString(2));&#10;                map.put(&quot;AttendanceGrade&quot;, cursor.getString(3));&#10;                map.put(&quot;MidtermGrade&quot;, cursor.getString(4));&#10;                map.put(&quot;FinalGrade&quot;, cursor.getString(5));&#10;                map.put(&quot;TotalMarks&quot;, cursor.getString(6));&#10;                list.add(map);&#10;            } while (cursor.moveToNext());&#10;        }&#10;        cursor.close();&#10;        db.close();&#10;        return list;&#10;    }&#10;&#10;    public String getDoctorIdByUserId(int userId) {&#10;        SQLiteDatabase db = this.getReadableDatabase();&#10;        String doctorId = null;&#10;        Cursor cursor = null;&#10;        try {&#10;            cursor = db.rawQuery(&quot;SELECT DoctorID FROM &quot; + TABLE_DOCTORS + &quot; WHERE UserID = ?&quot;, new String[]{String.valueOf(userId)});&#10;            if (cursor != null &amp;&amp; cursor.moveToFirst()) {&#10;                doctorId = cursor.getString(0);&#10;            }&#10;        } catch (Exception e) {&#10;            android.util.Log.e(&quot;DB_ERROR&quot;, &quot;getDoctorIdByUserId: &quot; + e.getMessage());&#10;        } finally {&#10;            if (cursor != null) cursor.close();&#10;            db.close();&#10;        }&#10;        return doctorId;&#10;    }&#10;    public boolean deleteStudent(String studentID) {&#10;        SQLiteDatabase db = this.getWritableDatabase();&#10;        try {&#10;            int rows = db.delete(TABLE_STUDENTS, &quot;StudentID = ?&quot;, new String[]{studentID});&#10;            return rows &gt; 0;&#10;        } catch (Exception e) {&#10;            Log.e(&quot;DB_ERROR&quot;, &quot;Error deleting student: &quot; + e.getMessage());&#10;            return false;&#10;        } finally {&#10;            db.close();&#10;        }&#10;    }&#10;    public boolean updateStudent(String studentID, String courseName, double attendance,&#10;                                 double mid, double finalExam, double total, String grade) {&#10;        SQLiteDatabase db = this.getWritableDatabase();&#10;        ContentValues values = new ContentValues();&#10;        values.put(&quot;Course&quot;, courseName);&#10;        values.put(&quot;AttendanceGrade&quot;, attendance);&#10;        values.put(&quot;MidtermGrade&quot;, mid);&#10;        values.put(&quot;FinalGrade&quot;, finalExam);&#10;        values.put(&quot;TotalMarks&quot;, total);&#10;        values.put(&quot;LetterGrade&quot;, grade);&#10;&#10;        int rows = db.update(TABLE_STUDENTS, values, &quot;StudentID=?&quot;, new String[]{studentID});&#10;        db.close();&#10;        return rows &gt; 0;&#10;    }&#10;&#10;    @Override&#10;    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {&#10;        db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_STUDENTS);&#10;        db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_DOCTORS);&#10;        db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_USERS);&#10;        onCreate(db);&#10;    }&#10;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/unigrademanagerproject/managestudents.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/unigrademanagerproject/managestudents.java" />
              <option name="originalContent" value="package com.example.unigrademanagerproject;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.View;&#10;import android.widget.Button;&#10;import android.widget.ListView;&#10;import android.widget.SearchView;&#10;import android.widget.SimpleAdapter;&#10;&#10;import androidx.activity.EdgeToEdge;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;&#10;import java.util.ArrayList;&#10;import java.util.HashMap;&#10;import android.view.ContextMenu;&#10;import android.view.Menu;&#10;import android.view.MenuItem;&#10;import android.widget.AdapterView;&#10;import android.widget.Toast;&#10;&#10;public class managestudents extends AppCompatActivity {&#10;    Button btn, btnRefresh;&#10;    ListView lst;&#10;    SearchView searchView;&#10;    UniGradeDBClass db;&#10;    ArrayList&lt;HashMap&lt;String, String&gt;&gt; originalStudentList;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        EdgeToEdge.enable(this);&#10;        setContentView(R.layout.activity_managestudents);&#10;&#10;        db = new UniGradeDBClass(this);&#10;        lst = findViewById(R.id.lststudents);&#10;        btn = findViewById(R.id.btncancel);&#10;        btnRefresh = findViewById(R.id.btnrefresh);&#10;        searchView = findViewById(R.id.searchstudent);&#10;        // Register ListView for Context Menu&#10;        registerForContextMenu(lst);&#10;&#10;        // Load all students with doctor info&#10;        loadStudents();&#10;&#10;        // Refresh button - reload data from database&#10;        btnRefresh.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                loadStudents();&#10;                searchView.setQuery(&quot;&quot;, false);&#10;                searchView.clearFocus();&#10;                Toast.makeText(managestudents.this, &quot;Student list refreshed&quot;, Toast.LENGTH_SHORT).show();&#10;            }&#10;        });&#10;&#10;        // Cancel button&#10;        btn.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                Intent i = new Intent(managestudents.this, admindashboard.class);&#10;                startActivity(i);&#10;                finish();&#10;            }&#10;        });&#10;&#10;        // Search functionality - filter by student name OR doctor name&#10;        searchView.setOnQueryTextListener(new SearchView.OnQueryTextListener() {&#10;            @Override&#10;            public boolean onQueryTextSubmit(String query) {&#10;                return false;&#10;            }&#10;&#10;            @Override&#10;            public boolean onQueryTextChange(String newText) {&#10;                filterStudents(newText);&#10;                return true;&#10;            }&#10;        });&#10;    }&#10;&#10;    @Override&#10;    protected void onResume() {&#10;        super.onResume();&#10;        // Reload students from database when returning to this activity&#10;        loadStudents();&#10;    }&#10;&#10;    private void loadStudents() {&#10;        originalStudentList = db.getAllStudents();&#10;        displayStudents(originalStudentList);&#10;    }&#10;&#10;    private void displayStudents(ArrayList&lt;HashMap&lt;String, String&gt;&gt; studentList) {&#10;        SimpleAdapter adapter = new SimpleAdapter(&#10;                managestudents.this,&#10;                studentList,&#10;                R.layout.activity_custom2,&#10;                new String[]{&quot;StudentName&quot;, &quot;Course&quot;, &quot;AttendanceGrade&quot;, &quot;MidtermGrade&quot;, &quot;FinalGrade&quot;, &quot;TotalMarks&quot;},&#10;                new int[]{R.id.colname, R.id.colcourse, R.id.colattendance, R.id.colmidterm, R.id.colfinal, R.id.coltotal}&#10;        );&#10;        lst.setAdapter(adapter);&#10;    }&#10;&#10;    private void filterStudents(String query) {&#10;        ArrayList&lt;HashMap&lt;String, String&gt;&gt; filteredList = new ArrayList&lt;&gt;();&#10;&#10;        // If search is empty, show all students&#10;        if (query == null || query.trim().isEmpty()) {&#10;            filteredList.addAll(originalStudentList);&#10;        } else {&#10;            String lowerQuery = query.toLowerCase();&#10;&#10;            // Filter by student name OR doctor name&#10;            for (HashMap&lt;String, String&gt; student : originalStudentList) {&#10;                String studentName = student.get(&quot;StudentName&quot;).toLowerCase();&#10;                String doctorName = student.get(&quot;DoctorName&quot;).toLowerCase();&#10;&#10;                // If student name OR doctor name contains the search query&#10;                if (studentName.contains(lowerQuery) || doctorName.contains(lowerQuery)) {&#10;                    filteredList.add(student);&#10;                }&#10;            }&#10;        }&#10;&#10;        // Update ListView with filtered results&#10;        displayStudents(filteredList);&#10;    }&#10;    //Add string array to app/src/main/res/values/strings.xml&#10;    //&lt;string-array name=&quot;CmdMenu&quot;&gt;&#10;    //    &lt;item&gt;Edit&lt;/item&gt;&#10;    //    &lt;item&gt;Delete&lt;/item&gt;&#10;    //&lt;/string-array&gt;&#10;    // Create Context Menu&#10;    @Override&#10;    public void onCreateContextMenu(ContextMenu menu, View v, ContextMenu.ContextMenuInfo menuInfo) {&#10;        AdapterView.AdapterContextMenuInfo info = (AdapterView.AdapterContextMenuInfo) menuInfo;&#10;        menu.setHeaderTitle(&quot;Command for: &quot; + originalStudentList.get(info.position).get(&quot;StudentName&quot;));&#10;        String[] menuItems = getResources().getStringArray(R.array.CmdMenu);&#10;        for (int i = 0; i &lt; menuItems.length; i++) {&#10;            menu.add(Menu.NONE, i, i, menuItems[i]);&#10;        }&#10;    }&#10;&#10;    // Handle Context Menu Selection&#10;    @Override&#10;    public boolean onContextItemSelected(MenuItem item) {&#10;        AdapterView.AdapterContextMenuInfo info = (AdapterView.AdapterContextMenuInfo) item.getMenuInfo();&#10;        int menuItemIndex = item.getItemId();&#10;        String[] menuItems = getResources().getStringArray(R.array.CmdMenu);&#10;        String CmdName = menuItems[menuItemIndex];&#10;        String StudentID = originalStudentList.get(info.position).get(&quot;StudentID&quot;);&#10;&#10;        if (&quot;Edit&quot;.equals(CmdName)) {&#10;            Intent intent = new Intent(this,updatestudent.class);&#10;            // Pass all student data&#10;            HashMap&lt;String, String&gt; student = originalStudentList.get(info.position);&#10;            intent.putExtra(&quot;StudentID&quot;, student.get(&quot;StudentID&quot;));&#10;            intent.putExtra(&quot;StudentName&quot;, student.get(&quot;StudentName&quot;));&#10;            intent.putExtra(&quot;Course&quot;, student.get(&quot;Course&quot;));&#10;            intent.putExtra(&quot;Attendance&quot;, student.get(&quot;AttendanceGrade&quot;));&#10;            intent.putExtra(&quot;Mid&quot;, student.get(&quot;MidtermGrade&quot;));&#10;            intent.putExtra(&quot;Final&quot;, student.get(&quot;FinalGrade&quot;));&#10;&#10;            startActivity(intent);&#10;        } else if (&quot;Delete&quot;.equals(CmdName)) {&#10;            boolean deleted = db.deleteStudent(StudentID);&#10;            if (deleted) {&#10;                Toast.makeText(this, &quot;Student deleted successfully&quot;, Toast.LENGTH_LONG).show();&#10;                originalStudentList = db.getAllStudents();&#10;                displayStudents(originalStudentList);&#10;            } else {&#10;                Toast.makeText(this, &quot;Failed to delete student&quot;, Toast.LENGTH_LONG).show();&#10;            }&#10;        }&#10;&#10;        return true;&#10;    }&#10;&#10;&#10;&#10;}" />
              <option name="updatedContent" value="package com.example.unigrademanagerproject;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.View;&#10;import android.widget.Button;&#10;import android.widget.ListView;&#10;import android.widget.SearchView;&#10;import android.widget.SimpleAdapter;&#10;&#10;import androidx.activity.EdgeToEdge;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;&#10;import java.util.ArrayList;&#10;import java.util.HashMap;&#10;import android.view.ContextMenu;&#10;import android.view.Menu;&#10;import android.view.MenuItem;&#10;import android.widget.AdapterView;&#10;import android.widget.Toast;&#10;&#10;public class managestudents extends AppCompatActivity {&#10;    Button btn, btnRefresh;&#10;    ListView lst;&#10;    SearchView searchView;&#10;    UniGradeDBClass db;&#10;    ArrayList&lt;HashMap&lt;String, String&gt;&gt; originalStudentList;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        EdgeToEdge.enable(this);&#10;        setContentView(R.layout.activity_managestudents);&#10;&#10;        db = new UniGradeDBClass(this);&#10;        lst = findViewById(R.id.lststudents);&#10;        btn = findViewById(R.id.btncancel);&#10;        btnRefresh = findViewById(R.id.btnrefresh);&#10;        searchView = findViewById(R.id.searchstudent);&#10;        // Register ListView for Context Menu&#10;        registerForContextMenu(lst);&#10;&#10;        // Load all students with doctor info&#10;        loadStudents();&#10;&#10;        // Refresh button - reload data from database&#10;        btnRefresh.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                loadStudents();&#10;                searchView.setQuery(&quot;&quot;, false);&#10;                searchView.clearFocus();&#10;                Toast.makeText(managestudents.this, &quot;Student list refreshed&quot;, Toast.LENGTH_SHORT).show();&#10;            }&#10;        });&#10;&#10;        // Cancel button&#10;        btn.setOnClickListener(new View.OnClickListener() {&#10;            @Override&#10;            public void onClick(View v) {&#10;                Intent i = new Intent(managestudents.this, admindashboard.class);&#10;                startActivity(i);&#10;                finish();&#10;            }&#10;        });&#10;&#10;        // Search functionality - filter by student name OR doctor name&#10;        searchView.setOnQueryTextListener(new SearchView.OnQueryTextListener() {&#10;            @Override&#10;            public boolean onQueryTextSubmit(String query) {&#10;                return false;&#10;            }&#10;&#10;            @Override&#10;            public boolean onQueryTextChange(String newText) {&#10;                filterStudents(newText);&#10;                return true;&#10;            }&#10;        });&#10;    }&#10;&#10;    @Override&#10;    protected void onResume() {&#10;        super.onResume();&#10;        // Reload students from database when returning to this activity&#10;        loadStudents();&#10;    }&#10;&#10;    private void loadStudents() {&#10;        originalStudentList = db.getAllStudents();&#10;        displayStudents(originalStudentList);&#10;    }&#10;&#10;    private void displayStudents(ArrayList&lt;HashMap&lt;String, String&gt;&gt; studentList) {&#10;        SimpleAdapter adapter = new SimpleAdapter(&#10;                managestudents.this,&#10;                studentList,&#10;                R.layout.activity_custom2,&#10;                new String[]{&quot;StudentName&quot;, &quot;Course&quot;, &quot;AttendanceGrade&quot;, &quot;MidtermGrade&quot;, &quot;FinalGrade&quot;, &quot;TotalMarks&quot;},&#10;                new int[]{R.id.colname, R.id.colcourse, R.id.colattendance, R.id.colmidterm, R.id.colfinal, R.id.coltotal}&#10;        );&#10;        lst.setAdapter(adapter);&#10;    }&#10;&#10;    private void filterStudents(String query) {&#10;        ArrayList&lt;HashMap&lt;String, String&gt;&gt; filteredList = new ArrayList&lt;&gt;();&#10;&#10;        // If search is empty, show all students&#10;        if (query == null || query.trim().isEmpty()) {&#10;            filteredList.addAll(originalStudentList);&#10;        } else {&#10;            String lowerQuery = query.toLowerCase();&#10;&#10;            // Filter by student name OR doctor name&#10;            for (HashMap&lt;String, String&gt; student : originalStudentList) {&#10;                String studentName = student.get(&quot;StudentName&quot;).toLowerCase();&#10;                String doctorName = student.get(&quot;DoctorName&quot;).toLowerCase();&#10;&#10;                // If student name OR doctor name contains the search query&#10;                if (studentName.contains(lowerQuery) || doctorName.contains(lowerQuery)) {&#10;                    filteredList.add(student);&#10;                }&#10;            }&#10;        }&#10;&#10;        // Update ListView with filtered results&#10;        displayStudents(filteredList);&#10;    }&#10;    //Add string array to app/src/main/res/values/strings.xml&#10;    //&lt;string-array name=&quot;CmdMenu&quot;&gt;&#10;    //    &lt;item&gt;Edit&lt;/item&gt;&#10;    //    &lt;item&gt;Delete&lt;/item&gt;&#10;    //&lt;/string-array&gt;&#10;    // Create Context Menu&#10;    @Override&#10;    public void onCreateContextMenu(ContextMenu menu, View v, ContextMenu.ContextMenuInfo menuInfo) {&#10;        AdapterView.AdapterContextMenuInfo info = (AdapterView.AdapterContextMenuInfo) menuInfo;&#10;        menu.setHeaderTitle(&quot;Command for: &quot; + originalStudentList.get(info.position).get(&quot;StudentName&quot;));&#10;        String[] menuItems = getResources().getStringArray(R.array.CmdMenu);&#10;        for (int i = 0; i &lt; menuItems.length; i++) {&#10;            menu.add(Menu.NONE, i, i, menuItems[i]);&#10;        }&#10;    }&#10;&#10;    // Handle Context Menu Selection&#10;    @Override&#10;    public boolean onContextItemSelected(MenuItem item) {&#10;        AdapterView.AdapterContextMenuInfo info = (AdapterView.AdapterContextMenuInfo) item.getMenuInfo();&#10;        int menuItemIndex = item.getItemId();&#10;        String[] menuItems = getResources().getStringArray(R.array.CmdMenu);&#10;        String CmdName = menuItems[menuItemIndex];&#10;        String StudentID = originalStudentList.get(info.position).get(&quot;StudentID&quot;);&#10;&#10;        if (&quot;Edit&quot;.equals(CmdName)) {&#10;            Intent intent = new Intent(this,updatestudent.class);&#10;            // Pass all student data&#10;            HashMap&lt;String, String&gt; student = originalStudentList.get(info.position);&#10;            intent.putExtra(&quot;StudentID&quot;, student.get(&quot;StudentID&quot;));&#10;            intent.putExtra(&quot;StudentName&quot;, student.get(&quot;StudentName&quot;));&#10;            intent.putExtra(&quot;Course&quot;, student.get(&quot;Course&quot;));&#10;            intent.putExtra(&quot;Attendance&quot;, student.get(&quot;AttendanceGrade&quot;));&#10;            intent.putExtra(&quot;Mid&quot;, student.get(&quot;MidtermGrade&quot;));&#10;            intent.putExtra(&quot;Final&quot;, student.get(&quot;FinalGrade&quot;));&#10;&#10;            startActivity(intent);&#10;        } else if (&quot;Delete&quot;.equals(CmdName)) {&#10;            boolean deleted = db.deleteStudent(StudentID);&#10;            if (deleted) {&#10;                Toast.makeText(this, &quot;Student deleted successfully&quot;, Toast.LENGTH_LONG).show();&#10;                originalStudentList = db.getAllStudents();&#10;                displayStudents(originalStudentList);&#10;            } else {&#10;                Toast.makeText(this, &quot;Failed to delete student&quot;, Toast.LENGTH_LONG).show();&#10;            }&#10;        }&#10;&#10;        return true;&#10;    }&#10;&#10;&#10;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>